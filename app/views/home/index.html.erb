<% home_page %>

<% content_for :header_including do %>
     <%= stylesheet_link_tag  "s3Slider" %>
     <%= javascript_include_tag "home", "s3Slider" %>
<% end %>

<div id="news_block" class="block round">
    <div class="image_frame">
        <div id="s3slider">
           <ul id="s3sliderContent">
             <% @hot_articles.each do |article| %>
                <li class="s3sliderImage">
                    <%= link_to(get_image_of_item(article, 0, 320, 240) , article)  %>
                    <span><h3><%= article.title %></h3></span>
              </li>
             <% end %>
           </ul>
        </div>
    </div>
    <div id="articles_frame">
        <ul>
            <% @hot_articles.each do |article| %>
                <li><h4><%= link_to article.title, article %></h4></li>
            <% end %>
        </ul>
    </div>
    <div id="search_frame">
        <h2><%= t("home.foods_buy_question") %></h2>
        <p><%= t("home.foods_buy_question_description") %></p>
        <%= form_tag 'home/items', :method => :get do %>
                <%= text_field_tag :search %>
                <%= submit_tag t("home.foods_search_button"), :class => "button" %><br/>
                <p class="trivial"><%= t("home.multiple_foods_suggestion")  %></p>
        <% end %>
    </div>
</div>

<div>
    <ul class="menu" id="actions_menu">
        <li><%= link_to t("reviews.new_review"), choose_mode_reviews_path, :class => "button" %></li>
        <li><%= link_to t("recommendations.new_recommendation"), new_recommendation_path, :class => "button" %></li>
    </ul>
</div>

<div class="two_columns_container" >
    <div id="pagination" class="left_column">
    <% @items.each do |item| %>
        <%= render "info_items/info_item", :item => item %>
    <% end %>
    </div> <!--end of info_items -->

     <div id="control_panel" class="right_column">
        <% if current_user %>
            <div id="user_panel" class="sub_panel">
                <h3><%= current_user.login_name %></h3>
                <%= get_avatar(current_user) %>
                 <p><%= link_to t("home.control_panel.update_profile"), profile_edit_path %>
                | <%= link_to t("authentication.logout"), logout_path %></p>
            </div>
            <hr/>
            <h3><%= t("home.control_panel.watching") %></h3>
            <dl class="tab">
                <dt><span><%= t("home.control_panel.watched_foods") %></span></dt>
                    <dd id="watched_foods_list">
                        <% if current_user && current_user.profile.watched_foods %>
                            <% current_user.profile.watched_foods.each do |tag| %>
                                <h4><%= link_to tag, {:action => "items", :tags => tag} %><%= get_severity_of_food(tag) %></h4>
                            <% end %>
                        <% end %>
                        <%= form_tag :action => "watch_foods" do %>
                            <%= text_field_tag "added_foods" %>
                            <%= submit_tag t("general.add"), :class => "button" %>
                            <p class="trivial"><%= t("home.control_panel.add_foods_suggestion") %></p>
                        <% end %>
                    </dd>
                <dt><span><%= t("home.control_panel.watched_locations") %></span></dt>
                    <dd id="watched_locations_list">
                        <% if current_user && current_user.profile.watched_locations %>
                            <% current_user.profile.watched_locations.each do |location| %>
                                <p id="<%= location.id.to_s %>">
                                    <%= content_tag :span, location.address %>
                                    <%= link_to t("general.show"), locations_show_nearby_items_path(:location_id => location.id) %>
                                </p>
                            <% end %>
                      <% end %>
                    </dd>
                <dt><span><%= t("home.control_panel.watched_tips") %></span></dt>
                    <dd id="watched_tips_list">
                        <% @my_tips.each do |tip| %>
                            <%= link_to tip.title, tip, 'data-content' => tip.content, :class => "tip" %>
                        <% end %>
                    </dd>
                <dt><span><%= t("home.control_panel.joined_groups") %></span></dt>
                    <dd id="joined_groups_list">
                        <% @my_groups.each do |group| %>
                            <%= link_to group.name, group %>
                        <% end %>
                    </dd>
            </dl>
        <% else %>
            <div id="login_panel" class="sub_panel">
                <%= link_to t("authentication.login"), new_sessions_path %>
                | <%= link_to t("authentication.sign_up"), new_user_path %>
            </div>
        <% end %>
        <hr/>

        <div id="tag_cloud" class="sub_panel">
            <h3><%= t("home.hot_tags") %></h3>
            <% tag_cloud InfoItem.tags_with_weight[0..GlobalConstants::TAG_CLOUD_COUNT] do |name, css_class| %>
                <%= link_to name, {:action => "items", :tags => name}, :class => css_class %>
            <% end %>
        </div> <!--end of tag_cloud -->

    </div> <!--end of control_panel -->
</div><!--end of two_columns_block -->








