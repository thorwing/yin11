<%= stylesheet_link_tag "upload" %>

<div id="desire_fields">
    <%= form_for @desire do |f| %>
        <%= render "shared/error_messages", target: @desire %>

        <div class="grid_7">
            <div id="upload_area" class="b_white"  >
                <%= hidden_field_tag "authenticity_token", form_authenticity_token, :id => "tokentag" %>
                <div id="desire_uploader"></div>
                <div id="upload_spinner" class="display_none" align="center" ><%= image_tag "loading_big.gif", width: 64, height: 64 %></div>
                <div id="images_container"align="center">
                </div>
            </div>

            <span><%= "描述一下它有多诱人吧：" %></span><br/>
            <%= f.text_area :content, :maxlength => get_max_length(@desire, :content), 'data-comment_max_len' => get_max_length(@desire, :content), :class => "char_aware" %>
            <%= content_tag :span, "", class: "char_saver display_none" %>
            <%= content_tag :span, "", class: "char_counter block trivial" %>
        </div>

        <div class="fl display_inline" style="width:400px;">
            <div class="field">
                 <b><%= f.label :tags_string, t("tags.tags") %></b>
                 <%= f.text_field :tags_string, 'data-pre' => (f.object.tags ? f.object.tags.map { |t| { :id => t, :name => t }} : []).to_json, class: "tags_input" %>
            </div>
            <%= render "tags/tags_options" %>
        </div>

        <div class="clearfix"></div>
        <% if current_user_has_permission? :editor %>
            <%= render "shared/text_field", :f => f, :label => t("general.priority"), :field => :priority %>
        <% end %>
        <div class= "mt10"><%= f.submit t("general.publish"), class: "button", id: "submit_desire" %> </div>
    <% end %>
</div>

<%= javascript_tag "desire_upload();" %>